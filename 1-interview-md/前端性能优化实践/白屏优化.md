## [离线包方案](https://juejin.cn/post/7254549436625256506)

## [首屏优化](https://juejin.cn/post/7267436042507911179)(https://juejin.cn/post/7280436036957716515)

### 1. 容器启动

App 打开 H5 页面的第一步并不是建立页面请求连接，而是初始化 Webview 首次初始化 Webview 耗时相对较长，大概在数百 ms ；而二次打开就较快了，大概在数十 ms

**解决方案**：容器启动优化的目标就是将初始化的这段时间省去，常用的解决方案是容器预建

### 2. 资源加载

容器启动后，客户端将发起页面请求并加载资源
**常用的优化手段包括**

1.  网络建连优化：优化网络连接，让解析更快、链路更短
    利用 DNS 预解析以及 DNS 缓存，让请求解析更快
    利用 CDN、域名智能调度等方案，自动选择链路较短的服务
    根据经验，这块的优化能够节省数十 ms 到数百 ms 不等
2.  资源离线化
3.  资源分级下发
4.  资源预加载
    要想实现资源预加载，就得借助客户端能力： 在上一个页面（原生或者 Webview）调用 JSB ，传递需要预加载的资源地址，由客户端内部进行请求和缓存

### 3. 代码执行

#### 怎么减少白屏时间 （代码层面的性能优化）

1. 路由懒加载 组件懒加载
   懒加载前提的实现：ES6 的动态地加载模块——import()
   组件懒加载的使用场景
   1. 该页面的 JS 文件体积大，导致页面打开慢，可以通过组件懒加载进行资源拆分，利用浏览器并行下载资源，提升下载速度（比如首页）
   2. 该组件不是一进入页面就展示，需要一定条件下才触发（比如弹框组件）
   3. 该组件复用性高，很多页面都有引入，利用组件懒加载抽离出该组件，一方面可以很好利用缓存，同时也可以减少页面的 JS 文件大小（比如表格组件、图形组件等）
2. 合理使用 Tree shaking 消除无用的 JS 代码，减少代码体积
   1. tree-shaking 原理
      依赖于 ES6 的模块特性，ES6 模块依赖关系是确定的，和运行时的状态无关，可以进行可靠的静态分析，这就是 tree-shaking 的基础
      静态分析就是不需要执行代码，就可以从字面量上对代码进行分析。ES6 之前的模块化，比如 CommonJS 是动态加载，只有执行后才知道引用的什么模块，就不能通过静态分析去做优化
   2. tree-shaking 只对使用 export 导出的变量生效
3. 骨架屏优化白屏时长 缩短白屏时间，提升用户体验
4. 长列表虚拟滚动
5. Web Worker 优化长任务
6. requestAnimationFrame 制作动画 该 api 可以解决用 setTimeout/setInterval 制作动画卡顿
7. js 加载方式优化 async、defer 是 script 标签 异步加载 通过 link 的 preload、prefetch 属性来预加载

### 4. 数据获取-数据预取 数据缓存

### 5. 绘制渲染-预渲染
